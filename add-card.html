<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Card Editor — Mini Card Game</title>
  <style>
    :root { --bg: #0f1220; --panel:#171a2b; --panel2:#1e2236; --text:#eaf0ff; --muted:#a7b0d6; --accent:#9df2d6; }
    *{box-sizing:border-box}
    body {margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial; background: var(--bg); color: var(--text);}    
    .wrap {max-width: 820px; margin: 0 auto; padding: 16px;}
    h1 {font-size: 22px; margin: 8px 0 12px;}
    h2 {font-size: 18px; margin: 16px 0 8px; color: var(--muted)}
    .card {background: linear-gradient(180deg, var(--panel), var(--panel2)); border: 1px solid #2a2f4a; border-radius: 16px; padding: 16px; box-shadow: 0 8px 24px rgba(0,0,0,.35)}
    .row {display:flex; gap: 12px; flex-wrap: wrap;}
    .btn {appearance:none; border:1px solid #2a2f4a; background: #202643; color: var(--text); padding: 12px 14px; border-radius: 12px; font-weight:600; cursor:pointer; touch-action: manipulation;}
    .btn:hover {filter: brightness(1.1)}
    .btn[disabled]{opacity:.5; filter:grayscale(1); cursor:not-allowed}
    .btn-primary{ background: linear-gradient(180deg, #2a4cf0, #1c36c9); border-color:#2d3fa7 }
    label {display:block; font-size:14px; color: var(--muted); margin-bottom:6px}
    input, select, textarea {width:100%; background:#111525; color:var(--text); border:1px solid #2a2f4a; border-radius:10px; padding:10px 12px}
    .stack {display:grid; gap:8px}
    .grid-3 {display:grid; grid-template-columns: repeat(3, 1fr); gap:8px}
    .c {min-width:88px; padding:10px; border-radius:14px; background:#12172b; border:1px solid #2a2f4a; text-align:center}
    .list {display:grid; gap:8px; max-height:360px; overflow:auto;}
    .item {padding:10px; border-radius:10px; background:#0f1631; border:1px solid #23314a; display:flex; justify-content:space-between; align-items:center}
    .muted{color:var(--muted); font-size:13px}
    .footer {margin-top:24px; color: var(--muted); font-size: 12px}
    pre {background:#071123; padding:12px; border-radius:10px; overflow:auto}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Card Editor</h1>

    <div class="card">
      <div class="stack">
        <div>
          <label>Card name</label>
          <input id="name" placeholder="Champion" />
        </div>
        <div>
          <label>Value</label>
          <input id="value" type="number" min="0" value="1" />
        </div>
        <div>
          <label>Type</label>
          <input id="type" placeholder="Starter" />
        </div>
        <div>
          <label>Tag</label>
          <input id="tag" placeholder="" />
        </div>
        <div>
          <label>Text</label>
          <textarea id="text" rows="2" placeholder="Optional description"></textarea>
        </div>
        <div>
          <label>Copies</label>
          <input id="copies" type="number" min="1" value="1" />
        </div>

        <div class="row">
          <button class="btn btn-primary" id="addBtn">Add card</button>
          <button class="btn" id="clearBtn">Clear fields</button>
          <button class="btn" id="exportBtn">Show JSON</button>
          <button class="btn" id="downloadBtn">Download JSON</button>
        </div>
      </div>
    </div>

    <h2>Custom cards</h2>
    <div class="card">
      <div class="stack">
        <div id="list" class="list"></div>
        <div>
          <label>Generated JSON (copy into index.html starterCards or save)</label>
          <pre id="out" style="white-space:pre-wrap; word-break:break-word">[]</pre>
        </div>
        <div class="row">
          <button class="btn" id="copySnippet">Copy index.html snippet</button>
          <a id="back" class="btn btn-ghost" href="/index.html">Back to game</a>
        </div>
      </div>
    </div>

    <div class="footer">Cards are stored in your browser's localStorage. Use "Show JSON" or "Download JSON" to export cards to paste into the game's starterCards array.</div>
  </div>

<script>
(function(){
  const $ = s => document.querySelector(s);
  const nameI = $('#name'), valueI = $('#value'), typeI = $('#type'), tagI = $('#tag'), textI = $('#text'), copiesI = $('#copies');
  const list = $('#list'), out = $('#out');
  const STORAGE_KEY = 'customCards_v1';

  let cards = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

  function renderList(){
    list.innerHTML = '';
    if(cards.length === 0){ list.append(Object.assign(document.createElement('div'),{className:'muted', innerText:'No custom cards yet.'})); return }
    cards.forEach((c,i)=>{
      const it = document.createElement('div'); it.className='item';
      it.innerHTML = `<div><strong>${c.name}</strong> <span class="muted">(${c.type || '—'})</span><div class="muted">Value: ${c.value} ×${c.copies}</div></div>`;
      const right = document.createElement('div');
      const del = document.createElement('button'); del.className='btn'; del.innerText='Remove'; del.onclick = ()=>{ cards.splice(i,1); save(); renderList(); };
      right.appendChild(del);
      it.appendChild(right);
      list.appendChild(it);
    });
    out.innerText = JSON.stringify(cards, null, 2);
  }

  function save(){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(cards));
    out.innerText = JSON.stringify(cards, null, 2);
  }

  function clearFields(){ nameI.value=''; valueI.value=1; typeI.value=''; tagI.value=''; textI.value=''; copiesI.value=1; }

  $('#addBtn').addEventListener('click', ()=>{
    const name = nameI.value.trim();
    const value = parseInt(valueI.value, 10) || 0;
    const type = typeI.value.trim();
    const tag = tagI.value.trim();
    const text = textI.value.trim();
    const copies = Math.max(1, parseInt(copiesI.value,10) || 1);
    if(!name){ alert('Name required'); return }
    const card = { name, value, type, tag, text, copies };
    cards.push(card);
    save();
    renderList();
    clearFields();
  });

  $('#clearBtn').addEventListener('click', clearFields);

  $('#exportBtn').addEventListener('click', ()=>{
    out.innerText = JSON.stringify(cards, null, 2);
    navigator.clipboard && navigator.clipboard.writeText(out.innerText).catch(()=>{});
    alert('JSON placed in the export box and (if permitted) copied to clipboard.');
  });

  $('#downloadBtn').addEventListener('click', ()=>{
    const blob = new Blob([JSON.stringify(cards, null, 2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download = 'custom-cards.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  });

  $('#copySnippet').addEventListener('click', ()=>{
    // Generate a snippet that can be pasted into index.html replacing or appended to starterCards
    const snippet = `// Custom cards exported from add-card.html\n` + `const customStarterCards = ${JSON.stringify(cards, null, 2)};\n` + `// You can merge customStarterCards into the existing starterCards array in index.html`;
    navigator.clipboard && navigator.clipboard.writeText(snippet).then(()=> alert('Snippet copied to clipboard'), ()=> alert('Unable to copy automatically — use the export box.'));
  });

  renderList();
})();
</script>
</body>
</html>
